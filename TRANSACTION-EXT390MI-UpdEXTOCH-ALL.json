{"programModules":{"EXT390MI":{"program":"EXT390MI","triggers":{},"transactions":{"UpdEXTOCH":{"sourceUuid":"571394a4-d588-432a-80bf-0b97299384b7","name":"UpdEXTOCH","program":"EXT390MI","description":"Update records in EXTOCH","active":true,"multi":false,"modified":1743272956698,"modifiedBy":"EXT_SK","outputFields":[],"inputFields":[{"name":"WHLO","description":"Warehouse","length":3,"mandatory":true,"type":"A","refField":null},{"name":"REPN","description":"Receiving number","length":10,"mandatory":true,"type":"N","refField":null},{"name":"CUNO","description":"Customer","length":10,"mandatory":false,"type":"A","refField":null},{"name":"RDFI","description":"Ready for Invoice","length":1,"mandatory":false,"type":"N","refField":null},{"name":"IVCD","description":"Invoice created","length":8,"mandatory":false,"type":"N","refField":null},{"name":"IVOR","description":"Invoice order","length":10,"mandatory":false,"type":"A","refField":null},{"name":"CBEI","description":"Credit before inspection","length":1,"mandatory":false,"type":"N","refField":null},{"name":"RMRK","description":"Return mark","length":1,"mandatory":false,"type":"N","refField":null}],"utilities":[],"market":"ALL"}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"571394a4-d588-432a-80bf-0b97299384b7":{"uuid":"571394a4-d588-432a-80bf-0b97299384b7","updated":1752563871238,"updatedBy":"EXT_SK","created":1740663118878,"createdBy":"EXT_SK","apiVersion":"0.15","beVersion":"16.0.0.20250521011729.6","language":"GROOVY","codeHash":"5322E3C369B2B354F2AF6C077A5BFEE35630FD2227DA7590788502D2B618A1ED","code":"LyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiBFeHRlbnNpb24gTmFtZTogRVhUMzkwTUkvVXBkRVhUT0NIDQogVHlwZTogRXh0ZW5kTTNUcmFuc2FjdGlvbg0KIFNjcmlwdCBBdXRob3I6IFN1c2FubmEgS2VsbGFuZGVyIC0gRWx2ZW5pdGUNCiBEYXRlOiAyMDI1LTAyLTI3DQogRGVzY3JpcHRpb246IFVwZGF0ZSByZWNvcmRzIGluIFh0ZW5kTTMgZHluYW1pYyBkQiBFWFRPQ0gsIGFkZGVkIGluZm9ybWF0aW9uIHRvIE9DSEVBRCBpbiBPSVMzOTAgDQoNCiBSZXZpc2lvbiBIaXN0b3J5Og0KIE5hbWUgICAgICAgICAgICAgICAgICAgIERhdGUgICAgICAgICAgICAgVmVyc2lvbiAgICAgICAgICBEZXNjcmlwdGlvbiBvZiBDaGFuZ2VzDQogU3VzYW5uYSBLZWxsYW5kZXIgICAgICAgMjAyNS0wMi0yNyAgICAgICAxLjAgICAgICAgICAgICAgIFNQMDAzMCAtIFVwZGF0ZSByZWNvcmRzIGluIFh0ZW5kTTMgZHluYW1pYyBkQiBFWFRPQ0gsIGFkZGVkIGluZm9ybWF0aW9uIHRvIE9DSEVBRCBpbiBPSVMzOTANCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8NCmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlVGltZQ0KaW1wb3J0IGphdmEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXINCnB1YmxpYyBjbGFzcyBVcGRFWFRPQ0ggZXh0ZW5kcyBFeHRlbmRNM1RyYW5zYWN0aW9uIHsgDQogIHByaXZhdGUgZmluYWwgTUlBUEkgbWkNCglwcml2YXRlIGZpbmFsIERhdGFiYXNlQVBJIGRhdGFiYXNlDQoJcHJpdmF0ZSBmaW5hbCBMb2dnZXJBUEkgbG9nZ2VyDQoJcHJpdmF0ZSBmaW5hbCBNSUNhbGxlckFQSSBtaUNhbGxlcg0KCXByaXZhdGUgZmluYWwgUHJvZ3JhbUFQSSBwcm9ncmFtICANCgkNCgkgaW50IGNvbXBhbnkgPSAwIA0KICAgU3RyaW5nIHdhcmVob3VzZSA9ICIiDQogICBsb25nIHJlY2VpdmluZ051bWJlciA9IDANCiAgIFN0cmluZyBjdXN0b21lciA9ICIiDQogICBpbnQgcmVhZHlGb3JJbnZvaWNlID0gMCANCiAgIGludCBjcmVkaXRCZWZvcmVJbnNwZWN0aW9uID0gMA0KICAgaW50IHJldHVybk1hcmsgPSAwIA0KICAgaW50IGludm9pY2VDcmVhdGVkID0gMCANCiAgIFN0cmluZyBpbnZvaWNlT3JkZXIgPSAiIiANCgkgDQoJIGludCBlbnRyeURhdGUgPSAwDQoJIGludCBlbnRyeVRpbWUgPSAwDQoJIA0KCSANCglwdWJsaWMgVXBkRVhUT0NIKE1JQVBJIG1pLCBEYXRhYmFzZUFQSSBkYXRhYmFzZSxQcm9ncmFtQVBJIHByb2dyYW0sIExvZ2dlckFQSSBsb2dnZXIpIHsNCiAgICB0aGlzLm1pID0gbWkNCiAgICB0aGlzLmRhdGFiYXNlID0gZGF0YWJhc2UNCiAgICB0aGlzLmxvZ2dlciA9IGxvZ2dlcg0KICAgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW0gDQogIH0NCg0KCQ0KICAvKg0KICAgIG1haW4gbWV0aG9kDQogICovDQogIHB1YmxpYyB2b2lkIG1haW4oKSB7ICANCiAgICBpZihyZXRyaWV2ZUlucHV0UGFyYW1ldGVycygpKSB7IA0KICAgICAgdXBkYXRlRVhUT0NIKCkNCiAgICB9IA0KICB9IA0KICAgDQogIC8qDQogICAgIENyZWF0ZSByZWNvcmQgaW4gRVhUT0NIDQoJKi8NCiAgcHVibGljIHZvaWQgdXBkYXRlRVhUT0NIKCl7IA0KICAgIA0KICAgICAgREJBY3Rpb24gZGJhRVhUT0NIID0gZGF0YWJhc2UudGFibGUoIkVYVE9DSCIpLmluZGV4KCIwMCIpLmJ1aWxkKCkgIA0KICAgICAgREJDb250YWluZXIgY29uRVhUT0NIID0gZGJhRVhUT0NILmdldENvbnRhaW5lcigpDQogICAgICBjb25FWFRPQ0guc2V0KCJFWENPTk8iLCBjb21wYW55KSANCiAgICAgIGNvbkVYVE9DSC5zZXQoIkVYV0hMTyIsIHdhcmVob3VzZSkgICAgDQogICAgICBjb25FWFRPQ0guc2V0KCJFWFJFUE4iLCByZWNlaXZpbmdOdW1iZXIpICANCiAgICAgIGNvbkVYVE9DSC5zZXQoIkVYQ1VOTyIsIGN1c3RvbWVyKSAgICAgICAgIA0KICAgICAgZGJhRVhUT0NILnJlYWRMb2NrKGNvbkVYVE9DSCwgdXBkYXRlQ2FsbEJhY2tFWFRPQ0gpICANCiAgfSAgICAgDQogICAgICAgIA0KICBDbG9zdXJlPD8+IHVwZGF0ZUNhbGxCYWNrRVhUT0NIID0geyBMb2NrZWRSZXN1bHQgbG9ja2VkUmVzdWx0IC0+IA0KIA0KICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYUkRGSSIsIGdldEludEZyb21JbnB1dFBhcmFtZXRlcihtaS5pbkRhdGEuZ2V0KCJSREZJIiksIGludm9pY2VDcmVhdGVkLCAoaW50KWxvY2tlZFJlc3VsdC5nZXQoIkVYUkRGSSIpKSkNCiAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWElWQ0QiLCBnZXRJbnRGcm9tSW5wdXRQYXJhbWV0ZXIobWkuaW5EYXRhLmdldCgiSVZDRCIpLCBpbnZvaWNlQ3JlYXRlZCwgKGludClsb2NrZWRSZXN1bHQuZ2V0KCJFWElWQ0QiKSkpDQogICAgbG9ja2VkUmVzdWx0LnNldCgiRVhJVk9SIiwgZ2V0U3RyaW5nRnJvbUlucHV0UGFyYW1ldGVyKHJlbW92ZU51bGxmcm9tU3RyaW5nT2JqZWN0KG1pLmluRGF0YS5nZXQoIklWT1IiKSkudG9TdHJpbmcoKSwgKFN0cmluZylsb2NrZWRSZXN1bHQuZ2V0KCJFWElWT1IiKSkpIA0KICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ0JFSSIsIGdldEludEZyb21JbnB1dFBhcmFtZXRlcihtaS5pbkRhdGEuZ2V0KCJDQkVJIiksIGNyZWRpdEJlZm9yZUluc3BlY3Rpb24sIChpbnQpbG9ja2VkUmVzdWx0LmdldCgiRVhDQkVJIikpKQ0KICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYUk1SSyIsIGdldEludEZyb21JbnB1dFBhcmFtZXRlcihtaS5pbkRhdGEuZ2V0KCJSTVJLIiksIHJldHVybk1hcmssIChpbnQpbG9ja2VkUmVzdWx0LmdldCgiRVhSTVJLIikpKQ0KICAgDQogICAgaW50IGNoYW5nZU5vID0gbG9ja2VkUmVzdWx0LmdldCgiRVhDSE5PIikNCiAgICBpbnQgbmV3Q2hhbmdlTm8gPSBjaGFuZ2VObyArIDEgDQogICAgbG9ja2VkUmVzdWx0LnNldCgiRVhMTURUIiwgZW50cnlEYXRlKSANCiAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWENITk8iLCBuZXdDaGFuZ2VObykgDQogICAgbG9ja2VkUmVzdWx0LnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpICAgIA0KICAgIGxvY2tlZFJlc3VsdC51cGRhdGUoKSANCg0KICB9DQogIA0KICANCiAgDQogIC8qDQogICAgcmV0cmlldmUgYW5kIGNoZWNrIGlucHV0IHBhcmFtZXRlcnMgDQoJKi8NCglib29sZWFuIHJldHJpZXZlSW5wdXRQYXJhbWV0ZXJzKCkgew0KCSAgDQoJCWNvbXBhbnkgPSAoSW50ZWdlcilwcm9ncmFtLmdldExEQVpEKCkuQ09OTyAgDQogICAgd2FyZWhvdXNlID0gcmVtb3ZlTnVsbGZyb21TdHJpbmdPYmplY3QobWkuaW4uZ2V0KCJXSExPIikpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYW5kYXRvcnkgZmllbGQgIA0KICAgICANCgkgIHJlY2VpdmluZ051bWJlciA9IHJlbW92ZU51bGxmcm9tTG9uZ09iamVjdChtaS5pbkRhdGEuZ2V0KCJSRVBOIikpICAgICAgICAgICAgICAgICAgICAgICAgLy8gd3JvbmcgaW4geHRlbmRNMyBmb3VuZGF0aW9uLCBtYW5kYXRvcnkgZmllbGQgICANCiAgICANCiAgICBjdXN0b21lciA9IHJlbW92ZU51bGxmcm9tU3RyaW5nT2JqZWN0KG1pLmluLmdldCgiQ1VOTyIpKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1hbmRhdG9yeSBmaWVsZCAgPw0KICAgIA0KICAgIGlmKCFjaGVja0VYVE9DSCgpKXsNCiAgICAgICBtaS5lcnJvcigiUmVjb3JkIGRvZXMgbm90IGV4aXN0IikgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIHJlY29yZCBkb2VzIG5vdCBleGlzdCwgZW5kIHByb2Nlc3MNCiAgICAgIHJldHVybiBmYWxzZQ0KICAgIH0gICAgDQogICAgDQogICAgcmVhZHlGb3JJbnZvaWNlID0gcmVtb3ZlTnVsbGZyb21JbnRPYmplY3QobWkuaW4uZ2V0KCJSREZJIikpICANCiAgICBpZighaXNOZWVkTm9WYWxpZGF0aW9uTnVtZXJpYyhtaS5pbkRhdGEuZ2V0KCJSREZJIikpKXsNCiAgICAgIGlmKCFpc1ZhbGlkSW5wdXQocmVhZHlGb3JJbnZvaWNlKSl7IA0KICAgICAgICBtaS5lcnJvcigiUmVhZHkgZm9yIGludm9pY2UgJHtyZWFkeUZvckludm9pY2V9IG11c3QgYmUgMCBvciAxIikNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICB9DQogICAgfQ0KICAgICANCg0KICAgIGludm9pY2VDcmVhdGVkID0gcmVtb3ZlTnVsbGZyb21JbnRPYmplY3QobWkuaW4uZ2V0KCJJVkNEIikpIA0KICAgIGlmKCFpc05lZWROb1ZhbGlkYXRpb25OdW1lcmljKG1pLmluRGF0YS5nZXQoIklWQ0QiKSkpew0KICAgICAgaWYoaW52b2ljZUNyZWF0ZWQgPiAwKXsNCiAgICAgICAgaWYgKCFjaGVja0NTWUNBTChpbnZvaWNlQ3JlYXRlZCkpIHsgICANCiAgICAgICAgICBtaS5lcnJvcigiSW52b2ljZSBjcmVhdGVkIGRhdGUgJHtpbnZvaWNlQ3JlYXRlZH0gaXMgaW52YWxpZCIpIA0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICB9ICANCgkgICAgfQ0KICAgIH0NCiAgICANCiAgICAgDQogICAgY3JlZGl0QmVmb3JlSW5zcGVjdGlvbiA9IHJlbW92ZU51bGxmcm9tSW50T2JqZWN0KG1pLmluLmdldCgiQ0JFSSIpKSAgDQogICAgaWYoIWlzTmVlZE5vVmFsaWRhdGlvbk51bWVyaWMobWkuaW5EYXRhLmdldCgiQ0JFSSIpKSl7DQogICAgICBpZighaXNWYWxpZElucHV0KGNyZWRpdEJlZm9yZUluc3BlY3Rpb24pKXsgDQogICAgICAgIG1pLmVycm9yKCJDcmVkaXQgYmVmb3JlIGluc3BlY3Rpb24gJHtjcmVkaXRCZWZvcmVJbnNwZWN0aW9ufSBtdXN0IGJlIDAgb3IgMSIpDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgfQ0KICAgIH0NCiAgICAgDQogICAgcmV0dXJuTWFyayA9IHJlbW92ZU51bGxmcm9tSW50T2JqZWN0KG1pLmluLmdldCgiUk1SSyIpKSAgDQogICAgaWYoIWlzTmVlZE5vVmFsaWRhdGlvbk51bWVyaWMobWkuaW5EYXRhLmdldCgiUk1SSyIpKSl7DQogICAgICBpZighaXNWYWxpZElucHV0KHJldHVybk1hcmspKXsgDQogICAgICAgIG1pLmVycm9yKCJSZXR1cm4gbWFyayAke3JldHVybk1hcmt9IG11c3QgYmUgMCBvciAxIikNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICB9DQogICAgfQ0KICAgICANCgkgICANCiANCiAgICANCiAgICByZXRyaWV2ZVRvZGF5c0RhdGUoKQ0KICAgIA0KICAgIHJldHVybiB0cnVlDQoJfQ0KIA0KIA0KICAvKg0KICAgIFJldHVybiB0cnVlIGlmIHJlY29yZCBleGlzdC4gDQogICovDQogIGJvb2xlYW4gY2hlY2tFWFRPQ0goKSB7DQogICAgDQogICAgREJBY3Rpb24gcXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiRVhUT0NIIikuaW5kZXgoIjAwIikuYnVpbGQoKSAgDQogICAgREJDb250YWluZXIgY29udGFpbmVyID0gcXVlcnkuZ2V0Q29udGFpbmVyKCkNCiAgICBjb250YWluZXIuc2V0KCJFWENPTk8iLCBjb21wYW55KSANCiAgICBjb250YWluZXIuc2V0KCJFWFdITE8iLCB3YXJlaG91c2UpICAgIA0KICAgIGNvbnRhaW5lci5zZXQoIkVYUkVQTiIsIHJlY2VpdmluZ051bWJlcikgIA0KICAgIGNvbnRhaW5lci5zZXQoIkVYQ1VOTyIsIGN1c3RvbWVyKSAgICAgDQogICAgICANCiAgICBib29sZWFuIGZvdW5kID0gcXVlcnkucmVhZChjb250YWluZXIpDQogICAgDQogICAgaWYgKCFmb3VuZCkgIHsNCiAgICAgIHJldHVybiBmYWxzZSAgDQogICAgfQ0KICAgICANCiAgICByZXR1cm4gdHJ1ZQ0KICB9DQogDQogICANCiAgIA0KICAvKg0KICAgIFJldHVybiB0cnVlIGlmIHJlY29yZCBleGlzdC4gDQogICovDQogICBib29sZWFuIGNoZWNrQ1NZQ0FMKGludCBpbklWQ0QpIHsNCiAgICAgREJBY3Rpb24gcXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiQ1NZQ0FMIikuaW5kZXgoIjAwIikuYnVpbGQoKQ0KICAgICBEQkNvbnRhaW5lciBjb250YWluZXIgPSBxdWVyeS5nZXRDb250YWluZXIoKQ0KICAgICBjb250YWluZXIuc2V0KCJDRENPTk8iLCBjb21wYW55KSAgIA0KICAgICBjb250YWluZXIuc2V0KCJDRERJVkkiLCAiICIpICANCiAgICAgY29udGFpbmVyLnNldCgiQ0RZTUQ4IiwgaW5JVkNEKSAgIA0KICAgIA0KICAgICBib29sZWFuIGZvdW5kID0gcXVlcnkucmVhZChjb250YWluZXIpDQogICAgICAgDQogICAgIGlmICghZm91bmQpICB7DQogICAgICAgcmV0dXJuIGZhbHNlICANCiAgICAgfWVsc2Ugew0KICAgICAgIHJldHVybiB0cnVlDQogICAgIH0gDQogICB9DQogICANCg0KICAgIA0KICAvKg0KICAgIFJldHVybiB0cnVlIGlmIHJlY29yZCBleGlzdC4gDQogICovDQogIGJvb2xlYW4gaXNWYWxpZElucHV0KGludCBpbkZMRCkgew0KICAgIGlmKGluRkxEIDwgMCB8fCBpbkZMRCA+IDEpeyAgDQogICAgICAgcmV0dXJuIGZhbHNlDQogICAgfQ0KICAgICAgcmV0dXJuIHRydWUgIA0KICB9DQogIA0KICAvKg0KICAgIFJldHVybiB0cnVlIGlmIHZhbGlkYXRpb24gaXMgbm90IG5lZWRlZCANCiAgKi8NCiAgYm9vbGVhbiBpc05lZWROb1ZhbGlkYXRpb25OdW1lcmljKFN0cmluZyBpbkZMRCkgeyAgICAgICAgICAgICAgLy8gaW5GbGQgZm9yIHRoZSBudW1lcmljIHZhbHVlIG5lZWRzIHRvIGJlICJpbkRhdGEiIGR1ZSB0byAiaW4iIGNhbm5vdCBpZGVudGlmeSAiPyIgb3IgYmxhbmsgdmFsdWUuIEZvciBhbHBoYSBmaWVsZCwgd2UgdXNlICJpbiINCiAgICBpZihpbkZMRCA9PSBudWxsKXsNCiAgICAgIGluRkxEID0gIiINCiAgICB9DQogICAgDQogICAgaWYgKGluRkxELnRyaW0oKSAhPSAiIiAmJiBpbkZMRC50cmltKCkgIT0gIj8iKXsgIA0KICAgICAgIHJldHVybiBmYWxzZSANCiAgICB9IA0KICAgICAgcmV0dXJuIHRydWUgIA0KICB9IA0KICANCg0KICANCiAgLyoNCiAgICBHZXQgdG9kYXlzIGRhdGUNCiAgKi8NCiAgcHVibGljIHZvaWQgcmV0cmlldmVUb2RheXNEYXRlKCkgew0KICAgIExvY2FsRGF0ZVRpbWUgZGF0ZVRpbWUgPSBMb2NhbERhdGVUaW1lLm5vdygpDQogICAgZW50cnlEYXRlID0gZGF0ZVRpbWUuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkNCiAgICBlbnRyeVRpbWUgPSBkYXRlVGltZS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkNCiAgfQ0KIA0KICAgDQogIC8vIGNoZWNrIGlmIGZpZWxkIGZyb20gTUkgaXMgbnVsbC4gUmV0dXJuIHplcm8gaW4gdGhhdCBjYXNlDQogIGludCByZW1vdmVOdWxsZnJvbUludE9iamVjdChPYmplY3QgZmllbGQpew0KICAgICBpZiAoZmllbGQgPT0gbnVsbCkgeyAgDQogICAgICAgcmV0dXJuIDANCiAgICAgfSBlbHNlIHsNCiAgICAgICByZXR1cm4gKGludCkgZmllbGQNCiAgICAgfQ0KICAgfQ0KICANCiAgIC8vIGNoZWNrIGlmIGZpZWxkIGZyb20gTUkgaXMgbnVsbC4gUmV0dXJuIGVtcHR5IHN0cmluZyBpbiB0aGF0IGNhc2UNCiAgIFN0cmluZyByZW1vdmVOdWxsZnJvbVN0cmluZ09iamVjdChPYmplY3QgZmllbGQpew0KICAgICBpZiAoZmllbGQgPT0gbnVsbCkgeyAgDQogICAgICAgcmV0dXJuICIiDQogICAgIH0gZWxzZSB7DQogICAgICAgcmV0dXJuIGZpZWxkDQogICAgIH0NCiAgIH0NCiAgIA0KICAgCS8vIGNoZWNrIGlmIGZpZWxkIGZyb20gTUkgaXMgbnVsbC4gUmV0dXJuIHplcm8gaW4gdGhhdCBjYXNlDQoJbG9uZyByZW1vdmVOdWxsZnJvbUxvbmdPYmplY3QoU3RyaW5nIGZpZWxkKXsNCgkJaWYgKGZpZWxkID09IG51bGwpIHsgIA0KCQkJcmV0dXJuIDANCgkJCX0gZWxzZSB7DQoJCQlyZXR1cm4gTG9uZy5wYXJzZUxvbmcoZmllbGQgKSANCgkJfQ0KCX0NCgkNCgkgIA0KICAvKg0KICAgIGdldCBpbnQgdmFsdWUgZnJvbSBpbnB1dCBwYXJhbWV0ZXIuIEhhbmRsZSBibGFuayB2YWx1ZXMgKG5vIHVwZGF0ZSkgYW5kID8gKHVwZGF0ZSB3aXRoIGJsYW5rKQ0KICAgIGlucHV0IHBhcmFtZXRlcnM6DQogICAgQHZhbHVlIC0gdmFsdWUgZnJvbSBNSSBpbnB1dCBwYXJhbWV0ZXINCiAgICBAZmllbGQgLSB2YWx1ZSBmcm9tIGRhdGFiYXNlICh1c2Ugd2hlbiBpbnB1dCBoYXMgYmxhbmsgdmFsdWUpDQogICovDQogIFN0cmluZyBnZXRTdHJpbmdGcm9tSW5wdXRQYXJhbWV0ZXIoU3RyaW5nIHZhbHVlLCBTdHJpbmcgZmllbGQpeyAgDQogICAgaWYgKHZhbHVlID09IG51bGwgfHwgdmFsdWUudHJpbSgpID09ICIgIiB8fCB2YWx1ZS50cmltKCkuaXNFbXB0eSgpKSB7ICANCiAgICAgIHJldHVybiBmaWVsZA0KICAgIH0gZWxzZSB7DQogICAgICBpZiAodmFsdWUudHJpbSgpID09ICI/IikgeyAvLyBCbGFuayB2YWx1ZSBpZiA/ICANCiAgICAgICAgcmV0dXJuICIiDQogICAgICB9IGVsc2UgeyAgDQogICAgICAgIHJldHVybiB2YWx1ZQ0KICAgICAgfQ0KICAgIH0gDQogIH0NCg0KCQ0KICAvKg0KICAgIGdldCBpbnQgdmFsdWUgZnJvbSBpbnB1dCBwYXJhbWV0ZXIuIEhhbmRsZSBibGFuayB2YWx1ZXMgKG5vIHVwZGF0ZSkgYW5kID8gKHVwZGF0ZSB3aXRoIDApDQogICAgaW5wdXQgcGFyYW1ldGVyczoNCiAgICBAdmFsdWVJbkRhdGEgLSB2YWx1ZSBmcm9tIE1JIGlucHV0IHBhcmFtZXRlciBhcyAiaW5EYXRhIg0KICAgIEB2YWx1ZUluIC0gdmFsdWUgZnJvbSBNSSBpbnB1dCwgbW92ZWQgdG8gaW50ZWdlciBmaWVsZA0KICAgIEBmaWVsZCAtIHZhbHVlIGZyb20gZGF0YWJhc2UgKHVzZSB3aGVuIGlucHV0IGhhcyBibGFuayB2YWx1ZSkNCiAgKi8gDQogIGludCBnZXRJbnRGcm9tSW5wdXRQYXJhbWV0ZXIoU3RyaW5nIHZhbHVlSW5EYXRhLCBpbnQgdmFsdWVJbiwgaW50IGZpZWxkKXsgDQogICAgaWYodmFsdWVJbkRhdGEgPT0gbnVsbCApew0KICAgICAgdmFsdWVJbkRhdGEgPSAiIg0KICAgIH0NCiAgICBpZiAodmFsdWVJbkRhdGEudHJpbSgpICE9ICIiKSB7IA0KICAgICAgaWYgKHZhbHVlSW5EYXRhLnRyaW0oKSA9PSAnPycpIHsgLy8gQmxhbmsgdmFsdWUgaWYgPyANCiAgICAgICAgcmV0dXJuIDANCiAgICAgIH0gZWxzZSB7IA0KICAgICAgICByZXR1cm4gKGludCl2YWx1ZUluDQogICAgICB9IA0KICAgIH0gDQogICAgcmV0dXJuIGZpZWxkDQogIH0NCiAgDQoNCn0gDQog"}}}